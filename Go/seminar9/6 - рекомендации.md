

# Рекомендации

## AAA

Arrange-Act-Assert -- паттерн написания тест-кейсов. Каждый тест-кейс разделяется на 3 блока:

1. Arrange -- инициализация параметров тест-кейса, например, настройка окружения и/или конфигурации,
подготовка БД, инициализация пользовательских сессий и т.п.
2. Act -- вызов кода приложения, который планируется тестировать. Результаты его работы будут анализироваться
в следующем блоке.
3. Assert -- утверждение ожиданий результатов работы; проверка, что фактические результаты запуска кода совпадают с ожидаемыми.

[Статья на англ. с несколькими примерами на python](https://automationpanda.com/2020/07/07/arrange-act-assert-a-pattern-for-writing-good-tests/).

Большинство тестов из примеров к этому занятию тоже следуют паттерну AAA, например:

```go
package myJson_test

import (
    "io"
    "testing"

    "github.com/stretchr/testify/assert"

    myJson "backend-academy/Go/seminar9/examples/part2/myjson"
)

func TestParseAndSortSlice(t *testing.T) {
    t.Parallel()

    type TestCase struct {
        name     string
        input    io.Reader
        expected []int
        err      error
    }

    // 1 - Arrange
    testCases := []TestCase{
        ...
    }

    for _, tc := range testCases {
        tc := tc
        t.Run(tc.name, func(tt *testing.T) {
            tt.Parallel()

            // 2 - Act
            actual, err := myJson.ParseAndSortSlice(tc.input)

            // 3 - Assert
            a := assert.New(tt)
            if tc.err != nil {
                a.EqualError(err, tc.err.Error())

                return
            }

            a.Nil(err) // или a.NoError(err)
            a.Equal(tc.expected, actual)
        })
    }
}
```

```go
package myMaps_test

import (
    "fmt"
    "math"
    "testing"

    "github.com/stretchr/testify/assert"

    myMaps "backend-academy/Go/seminar9/examples/part2/mymaps"
)

func TestMaxValue(t *testing.T) {
    t.Parallel()

    type TestCase struct {
        dict     map[string]float64
        expected float64
    }

    // 1 - Arrange
    testCases := []TestCase{
        {
            dict:     nil,
            expected: math.Inf(-1),
        },
        {
            dict:     map[string]float64{},
            expected: math.Inf(-1),
        },
        {
            dict:     map[string]float64{"a": 0},
            expected: 0,
        },
        {
            dict:     map[string]float64{"a": 1, "b": -100, "c": 25},
            expected: 25,
        },
    }

    for i, tc := range testCases {
        tc := tc
        t.Run(fmt.Sprintf("TestMaxValue_%d", i), func(tt *testing.T) {
            tt.Parallel()

            // 2 - Act
            actual := myMaps.MaxValue(tc.dict)

            // 3 - Assert
            assert.Equal(
                tt, tc.expected, actual,
                fmt.Sprintf("result must be %f, but got %f", tc.expected, actual),
            )
        })
    }
}
```